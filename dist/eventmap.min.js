/*! eventmap - v1.3.13 - 18-11-2013 */
(function(){!function(a){return udefine.configure(function(b){return this.globals(function(){return udefine.inject.add(a.toLowerCase(),{name:a,root:b})})})}("EventMap")}).call(this),function(){"use strict";var a,b,c,d,e=[].slice;!function(){return null!=Array.isArray?Array.isArray:Array.isArray=function(a){return a.push===Array.prototype.push&&null!=a.length}}(),d={}.hasOwnProperty,b=function(a,c){var e,f;null==a&&(a={});for(e in c)f=c[e],d.call(a,e)||("object"==typeof f?(a[e]={},b(a[e],f)):a[e]=f);return a},a=function(a){if("*"===a)throw new Error("* is not allowed as an event name")},c=function(a){return[].concat.call([],a)},udefine("eventmap",["root"],function(d){var f;return f=function(){function f(a){a=b(a,{shorthandFunctions:{enabled:!0,separator:"/"}}),this.sender=null,this.events={},this.validEvents=[],this.options=a}return f.alternateNames=!0,f.prototype.serialize=function(){var a,b;try{b=JSON.stringify(this.events,function(a,b){return"function"==typeof b&&(b=b.toString()),b})}catch(c){a=c,console.error("Error while serializing eventmap: "+a)}return b},f.prototype.deserialize=function(a){var b,c;try{c=JSON.parse(a,function(a,b){return 0===b.indexOf("function")&&(b=new Function(b)()),b})}catch(d){return b=d,console.error("Error while deserializing eventmap: "+b),!1}return this.events=c,!0},f.prototype.bind=function(a,b){var d,f,g,h;if(null==b&&(b=this),this.options.shorthandFunctions.enabled){for(Array.isArray(a)||(a=[a]),d=function(a){return b[a]?void 0:b[a]=function(){var b;return b=1<=arguments.length?e.call(arguments,0):[],this.trigger.apply(this,c([a,b]))}},g=0,h=a.length;h>g;g++)f=a[g],d(f);return this}},f.prototype.on=function(b,c){var d,e;if(c&&(a(b),!(this.validEvents.length>0&&-1===this.validEvents.indexOf(b))))return(d=this.events)[b]||(d[b]={id:-1,type:""}),((e=this.events[b]).now||(e.now=[])).push(c),this.bind(b),this},f.prototype.off=function(a){var b,c,e;if(a&&this.events[a])return e=this.events[a],b=e.id,c=e.type,("once"===c||"repeat"===c)&&("repeat"===c&&d.clearInterval(b),"once"===c&&d.clearTimeout(b)),this.events[a]&&delete this.events[a],this},f.prototype.one=function(a,b){var c=this;return this.on(a,function(){return b.apply(c,arguments),c.off(a)})},f.prototype.before=function(b,c){var d,e;if(c)return a(b),(d=this.events)[b]||(d[b]={}),((e=this.events[b]).before||(e.before=[])).push(c),this},f.prototype.after=function(b,c){var d,e;if(c)return a(b),(d=this.events)[b]||(d[b]={}),((e=this.events[b]).after||(e.after=[])).push(c),this},f.prototype.clear=function(){return this.events={},this.validEvents=[],this},f.prototype.all=function(){return this.trigger("*"),this},f.prototype.trigger=function(){var a,b,c,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=this;if(h=arguments[0],a=2<=arguments.length?e.call(arguments,1):[],null!=h)if("*"!==h){if(Array.isArray(h))for(q=0,s=h.length;s>q;q++)f=h[q],this.trigger(f,a);if("object"==typeof h?(j=h.name,i=h.interval,k=h.repeat,b=h.context,c=h.delay,l=h.sender):j=h,null!=(null!=(u=this.events[j])?u.now:void 0))return null==i&&(i=0),null==k&&(k=!1),null==b&&(b={}),null==c&&(c=0),null==l&&(l=this.sender),null==l&&(b.sender=l),o=function(){var c,d,e,g;return g=v.events[j].now||[],d=v.events[j].before||[],c=v.events[j].after||[],e=function(c){var d,e,g,h,i;if(null!=c)for(e=0,h=c.length;h>e;e++)if(d=c[e],"string"==typeof d)v.trigger(d,a);else if(Array.isArray(d))for(g=0,i=d.length;i>g;g++)f=d[g],v.trigger(f,a);else d.apply(b,a);return null},e(d),e(g),e(c)},g=this.events[j],n=function(){return i?k?(g.type="repeat",g.id=d.setInterval(function(){return o.call(this)},i)):(g.type="once",g.id=d.setTimeout(function(){return o.call(this)},i)):(g.type="direct",o.call(this)),null},c?m=d.setTimeout(function(){return n.call(this),d.clearTimeout(m)},c):n.call(this),this}else for(t=Object.keys(this.events),p=0,r=t.length;r>p;p++)f=t[p],this.trigger(f,a)},f.alternateNames&&(f.prototype.addListener=f.prototype.on,f.prototype.emit=f.prototype.trigger,f.prototype.once=f.prototype.one),f}()}),udefine.env.commonjs&&udefine.require("eventmap",function(a){return module.exports=a})}.call(this);