/*! eventmap - v1.2.0 - 02-09-2013 */
!function(){!function(a,b){return a.udefine.globals[b.toLowerCase()]=a[b],a.udefine.inject[b.toLowerCase()]={name:b,root:a}}(this,"EventMap")}.call(this),function(){"use strict";var a=[].slice;udefine("eventmap",["root"],function(b){var c;return c=function(){function c(){this.events={},this.validEvents=[]}return c.prototype.serialize=function(){var a,b;try{b=JSON.stringify(this.events,function(a,b){return"function"==typeof b&&(b=b.toString()),b})}catch(c){a=c,console.error("Error while serializing eventmap: "+a)}return b},c.prototype.deserialize=function(a){var b,c;try{c=JSON.parse(a,function(a,b){return 0===b.indexOf("function")&&(b=new Function(b)()),b})}catch(d){return b=d,console.error("Error while deserializing eventmap: "+b),!1}return this.events=c,!0},c.prototype.on=function(a,b){var c;if(b&&!(this.validEvents.length>0&&-1===this.validEvents.indexOf(a)))return c={event:b,id:-1,type:""},this.events[a]?this.events[a].push(c):this.events[a]=[c],this},c.prototype.off=function(a){var c;if(a)return c=this.events[a].type,("once"===c||"repeat"===c)&&("repeat"===c&&b.clearInterval(this.events[a].id),"once"===c&&b.clearTimeout(this.events[a].id)),this.events[a]&&delete this.events[a],this},c.prototype.clear=function(){return this.events={},this.validEvents=[],this},c.prototype.trigger=function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;if(f=arguments[0],c=2<=arguments.length?a.call(arguments,1):[],null!=f&&("object"==typeof f?(i=f.name,h=f.interval,j=f.repeat,d=f.context,e=f.delay,k=f.sender):i=f,this.events[i])){for(null==h&&(h=0),null==j&&(j=!1),null==d&&(d=this),null==e&&(e=0),n=function(a){return k?a.event.apply(d,[].concat.apply([],[[k],c])):a.event.apply(d,c)},q=this.events[i],o=0,p=q.length;p>o;o++)g=q[o],m=function(){return h?j?(g.type="repeat",g.id=b.setInterval(n,h)):(g.type="once",g.id=b.setTimeout(n,h)):(g.type="direct",n.call(this,g)),null},e?l=b.setTimeout(function(){return m.call(this,g),b.clearTimeout(l)}):m.call(this,g);return this}},c}()})}.call(this);