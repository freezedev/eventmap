/*! eventmap - v1.3.0 - 14-09-2013 */
!function(){!function(a){return udefine.configure(function(b){return this.globals[a.toLowerCase()]=b[a],this.inject[a.toLowerCase()]={name:a,root:b}})}("EventMap")}.call(this),function(){"use strict";var a,b,c,d=[].slice;c={}.hasOwnProperty,a=function(a,b){var d,e;null==a&&(a={});for(d in b)e=b[d],c.call(a,d)||(a[d]=e);return a},b=function(a){return[].concat.call([],a)},udefine("eventmap",["root"],function(e){var f;return f=function(){function f(b){b=a(b,{shorthandFunctions:!0,shorthandFunctionContext:this}),this.events={},this.validEvents=[],this.options=b}return f.prototype.serialize=function(){var a,b;try{b=JSON.stringify(this.events,function(a,b){return"function"==typeof b&&(b=b.toString()),b})}catch(c){a=c,console.error("Error while serializing eventmap: "+a)}return b},f.prototype.deserialize=function(a){var b,c;try{c=JSON.parse(a,function(a,b){return 0===b.indexOf("function")&&(b=new Function(b)()),b})}catch(d){return b=d,console.error("Error while deserializing eventmap: "+b),!1}return this.events=c,!0},f.prototype.on=function(a,e){var f,g=this;if(e&&!(this.validEvents.length>0&&-1===this.validEvents.indexOf(a)))return f={event:e,id:-1,type:""},this.events[a]?this.events[a].push(f):this.events[a]=[f],this.options.shorthandFunctions&&(c.call(this.options.shorthandFunctionContext,a)||(this.options.shorthandFunctionContext[a]=function(){var c;return c=1<=arguments.length?d.call(arguments,0):[],g.trigger.apply(g,b(a,c))})),this},f.prototype.off=function(a){var b;if(a)return b=this.events[a].type,("once"===b||"repeat"===b)&&("repeat"===b&&e.clearInterval(this.events[a].id),"once"===b&&e.clearTimeout(this.events[a].id)),this.events[a]&&delete this.events[a],this},f.prototype.clear=function(){return this.events={},this.validEvents=[],this},f.prototype.trigger=function(){var a,c,f,g,h,i,j,k,l,m,n,o,p,q,r;if(g=arguments[0],a=2<=arguments.length?d.call(arguments,1):[],null!=g&&("object"==typeof g?(j=g.name,i=g.interval,k=g.repeat,c=g.context,f=g.delay,l=g.sender):j=g,this.events[j])){for(null==i&&(i=0),null==k&&(k=!1),null==c&&(c=this),null==f&&(f=0),o=function(d){return l?d.event.apply(c,b([[l],a])):d.event.apply(c,a)},r=this.events[j],p=0,q=r.length;q>p;p++)h=r[p],n=function(){return i?k?(h.type="repeat",h.id=e.setInterval(o,i)):(h.type="once",h.id=e.setTimeout(o,i)):(h.type="direct",o.call(this,h)),null},f?m=e.setTimeout(function(){return n.call(this,h),e.clearTimeout(m)}):n.call(this,h);return this}},f}()})}.call(this);